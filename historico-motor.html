
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Histórico Motores</title>
  <style>
    body { font-family: Arial, sans-serif; font-size: 16px; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; }
    .foto { width: 100px; height: 80px; object-fit: cover; border: 1px solid #999; }
    button, input[type="file"] { margin-top: 5px; }
  </style>
</head>
<body>
  <div style="display: flex; align-items: center; border-bottom: 2px solid #ccc; padding-bottom: 10px; margin-bottom: 20px;">
    <img src="logo-pm.png" alt="Logotipo Polícia Marítima" style="height: 50px; margin-right: 15px;">
    <h1 style="font-size: 1.8em; margin: 0;">Validador Marítimo</h1>
  </div>

  <h2>Histórico de Validações de Motores</h2>
  <button onclick="location.href='validador.html'">⬅ Voltar ao Validador</button>
  <div id="tabelaHistorico"></div>

  <script>
    function carregarHistoricoMotor() {
      const historico = JSON.parse(localStorage.getItem('hisMotor') || '[]');
      let html = '<table><tr><th>Data</th><th>Marca</th><th>Campo1</th><th>Campo2</th><th>Válido</th><th>Mensagem</th><th>Foto</th></tr>';
      historico.forEach((item, i) => {
        const foto = item.foto || 'placeholder.jpg';
        html += `<tr>
          <td>${item.data}</td>
          <td>${item.marca}</td>
          <td>${item.campo1}</td>
          <td>${item.campo2 || ''}</td>
          <td>${item.valido}</td>
          <td>${item.msg}</td>
          <td>
            <img src="${foto}" class="foto" id="img${i}"><br>
            <input type="file" accept="image/*" onchange="guardarFoto(this, ${i})">
          </td>
        </tr>`;
      });
      html += '</table>';
      document.getElementById('tabelaHistorico').innerHTML = html;
    }

    function guardarFoto(input, index) {
      const file = input.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        const historico = JSON.parse(localStorage.getItem('hisMotor') || '[]');
        historico[index].foto = e.target.result;
        localStorage.setItem('hisMotor', JSON.stringify(historico));
        document.getElementById('img' + index).src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    window.addEventListener('DOMContentLoaded', carregarHistoricoMotor);
  </script>
</body>
</html>
