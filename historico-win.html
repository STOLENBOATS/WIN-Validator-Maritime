
<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Histórico WIN</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; vertical-align: top; }
    .foto { width: 100px; height: 80px; object-fit: cover; border: 1px solid #999; }
    button, input[type="file"] { margin-top: 5px; }
  </style>
</head>
<body onload="carregarHistoricoWIN()">
  <h2>Histórico de Validações WIN</h2>
  <button onclick="voltar()">⬅ Voltar ao Validador</button>
  <div id="tabelaHistorico"></div>

  <script>
    function voltar() {
      window.location.href = 'validador.html';
    }

    function carregarHistoricoWIN() {
      const historico = JSON.parse(localStorage.getItem('hisWIN') || '[]');
      let html = '<table><tr><th>Data</th><th>WIN</th><th>Válido</th><th>Mensagem</th><th>Foto</th></tr>';
      historico.forEach((item, i) => {
        const foto = item.foto || 'placeholder.jpg';
        html += `<tr>
          <td>${item.data}</td>
          <td>${item.win}</td>
          <td>${item.valido}</td>
          <td>${item.msg}</td>
          <td>
            <img src="${foto}" class="foto" id="img${i}"><br>
            <input type="file" accept="image/*" onchange="guardarFoto(this, ${i})">
          </td>
        </tr>`;
      });
      html += '</table>';
      document.getElementById('tabelaHistorico').innerHTML = html;
    }

    function guardarFoto(input, index) {
      const file = input.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = function(e) {
        const historico = JSON.parse(localStorage.getItem('hisWIN') || '[]');
        historico[index].foto = e.target.result;
        localStorage.setItem('hisWIN', JSON.stringify(historico));
        document.getElementById('img' + index).src = e.target.result;
      };
      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>
